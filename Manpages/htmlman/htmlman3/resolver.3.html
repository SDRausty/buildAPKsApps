<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>resolver(3) — Linux manual pages</title>
  <link rel="stylesheet" href="../stylesheet/manpages.css" type="text/css" />
  
  <link rel="home" href="../index.html" title="resolver(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  

  <div class="refentry" title="resolver(3) — Linux manual pages">
    <a id="resolver.3" name="resolver.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>res_init, res_query, res_search, res_querydomain,
      res_mkquery, res_send, dn_comp, dn_expand — resolver
      routines</p>
    </div>

    <div class="refsynopsisdiv" title="Synopsis">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;netinet/in.h&gt;
#include &lt;arpa/nameser.h&gt;
#include &lt;resolv.h&gt;
extern struct state _res;
</pre>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">res_init</b>(</code></td>

            <td rowspan="1" colspan="1"><code>void)</code>;</td>

            <td rowspan="1" colspan="1"> </td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">res_query</b>(</code></td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">dname</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">class</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">type</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">answer</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">anslen</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">res_search</b>(</code></td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">dname</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">class</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">type</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">answer</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">anslen</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">res_querydomain</b>(</code></td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">name</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">domain</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">class</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">type</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">answer</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">anslen</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">res_mkquery</b>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">op</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">dname</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">class</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">type</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">data</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">datalen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct rrec *<var class="pdparam">newrr</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">buf</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">buflen</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">res_send</b>(</code></td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">msg</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">msglen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">answer</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">anslen</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">dn_comp</b>(</code></td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">exp_dn</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">comp_dn</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">length</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char **<var class="pdparam">dnptrs</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char **<var class="pdparam">lastdnptr</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" class="funcprototype-table">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int <b class="fsfunc">dn_expand</b>(</code></td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">msg</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">eomorig</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned char *<var class="pdparam">comp_dn</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">exp_dn</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">length</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <p>Link with <code class="option">−lresolv</code>.</p>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1" title="DESCRIPTION">
      <a id="resolver-3_sect1" name="resolver-3_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>These functions make queries to and interpret the
      responses from Internet domain name servers.</p>

      <p>The <code class="function">res_init</code>() function
      reads the configuration files (see resolv.conf(5)) to get the
      default domain name, search order and name server
      address(es). If no server is given, the local host is tried.
      If no domain is given, that associated with the local host is
      used. It can be overridden with the environment variable
      <code class="constant">LOCALDOMAIN</code>. <code class="function">res_init</code>() is normally executed by the
      first call to one of the other functions.</p>

      <p>The <code class="function">res_query</code>() function
      queries the name server for the fully qualified domain name
      <em class="parameter"><code>name</code></em> of specified
      <em class="parameter"><code>type</code></em> and <em class="parameter"><code>class</code></em>. The reply is left in the
      buffer <em class="parameter"><code>answer</code></em> of
      length <em class="parameter"><code>anslen</code></em>
      supplied by the caller.</p>

      <p>The <code class="function">res_search</code>() function
      makes a query and waits for the response like <code class="function">res_query</code>(), but in addition implements the
      default and search rules controlled by <code class="constant">RES_DEFNAMES</code> and <code class="constant">RES_DNSRCH</code> (see description of <span class="structname">_res</span> options below).</p>

      <p>The <code class="function">res_querydomain</code>()
      function makes a query using <code class="function">res_query</code>() on the concatenation of
      <em class="parameter"><code>name</code></em> and <em class="parameter"><code>domain</code></em>.</p>

      <p>The following functions are lower-level routines used by
      <code class="function">res_query</code>().</p>

      <p>The <code class="function">res_mkquery</code>() function
      constructs a query message in <em class="parameter"><code>buf</code></em> of length <em class="parameter"><code>buflen</code></em> for the domain name
      <em class="parameter"><code>dname</code></em>. The query type
      <em class="parameter"><code>op</code></em> is usually
      <code class="constant">QUERY</code>, but can be any of the
      types defined in <code class="literal">&lt;</code><code class="filename">arpa/nameser.h</code><code class="literal">&gt;</code>
      <em class="parameter"><code>newrr</code></em> is currently
      unused.</p>

      <p>The <code class="function">res_send</code>() function
      sends a preformatted query given in <em class="parameter"><code>msg</code></em> of length <em class="parameter"><code>msglen</code></em> and returns the answer
      in <em class="parameter"><code>answer</code></em> which is of
      length <em class="parameter"><code>anslen</code></em>. It
      will call <code class="function">res_init</code>(), if it has
      not already been called.</p>

      <p>The <code class="function">dn_comp</code>() function
      compresses the domain name <em class="parameter"><code>exp_dn</code></em> and stores it in the
      buffer <em class="parameter"><code>comp_dn</code></em> of
      length <em class="parameter"><code>length</code></em>. The
      compression uses an array of pointers <em class="parameter"><code>dnptrs</code></em> to previously compressed
      names in the current message. The first pointer points to the
      beginning of the message and the list ends with NULL. The
      limit of the array is specified by <em class="parameter"><code>lastdnptr</code></em>. If <code class="varname">dnptr</code> is NULL, domain names are not
      compressed. If <em class="parameter"><code>lastdnptr</code></em> is NULL, the list of
      labels is not updated.</p>

      <p>The <code class="function">dn_expand</code>() function
      expands the compressed domain name <em class="parameter"><code>comp_dn</code></em> to a full domain name,
      which is placed in the buffer <em class="parameter"><code>exp_dn</code></em> of size <em class="parameter"><code>length</code></em>. The compressed name is
      contained in a query or reply message, and <em class="parameter"><code>msg</code></em> points to the beginning of
      the message.</p>

      <p>The resolver routines use global configuration and state
      information contained in the structure <span class="structname">_res</span>, which is defined in <code class="literal">&lt;</code><code class="filename">resolv.h</code><code class="literal">&gt;</code>
      The only field that is normally manipulated by the user is
      <em class="replaceable"><code>_res.options</code></em>. This
      field can contain the bitwise "OR" of the following
      options:</p>

      <div class="variablelist">
        <dl>
          <dt><span class="term"><code class="constant">RES_INIT</code></span></dt>

          <dd>
            <p>True if <code class="function">res_init</code>() has
            been called.</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_DEBUG</code></span></dt>

          <dd>
            <p>Print debugging messages.</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_AAONLY</code></span></dt>

          <dd>
            <p>Accept authoritative answers only. <code class="function">res_send</code>() continues until it finds
            an authoritative answer or returns an error. [Not
            currently implemented].</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_USEVC</code></span></dt>

          <dd>
            <p>Use TCP connections for queries rather than UDP
            datagrams.</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_PRIMARY</code></span></dt>

          <dd>
            <p>Query primary domain name server only.</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_IGNTC</code></span></dt>

          <dd>
            <p>Ignore truncation errors. Don't retry with TCP. [Not
            currently implemented].</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_RECURSE</code></span></dt>

          <dd>
            <p>Set the recursion desired bit in queries. Recursion
            is carried out by the domain name server, not by
            <code class="function">res_send</code>(). [Enabled by
            default].</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_DEFNAMES</code></span></dt>

          <dd>
            <p>If set, <code class="function">res_search</code>()
            will append the default domain name to single component
            names, i.e., those that do not contain a dot. [Enabled
            by default].</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_STAYOPEN</code></span></dt>

          <dd>
            <p>Used with <code class="constant">RES_USEVC</code> to
            keep the TCP connection open between queries.</p>
          </dd>

          <dt><span class="term"><code class="constant">RES_DNSRCH</code></span></dt>

          <dd>
            <p>If set, <code class="function">res_search</code>()
            will search for hostnames in the current domain and in
            parent domains. This option is used by <a class="link" href="../htmlman3/gethostbyname.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">gethostbyname</span>(3)</span></a>.
            [Enabled by default].</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1" title="RETURN VALUE">
      <a id="resolver-3_sect2" name="resolver-3_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>The <code class="function">res_init</code>() function
      returns 0 on success, or −1 if an error occurs.</p>

      <p>The <code class="function">res_query</code>(),
      <code class="function">res_search</code>(), <code class="function">res_querydomain</code>(), <code class="function">res_mkquery</code>() and <code class="function">res_send</code>() functions return the length of
      the response, or −1 if an error occurs.</p>

      <p>The <code class="function">dn_comp</code>() and
      <code class="function">dn_expand</code>() functions return
      the length of the compressed name, or −1 if an error
      occurs.</p>
    </div>

    <div class="refsect1" title="FILES">
      <a id="resolver-3_sect3" name="resolver-3_sect3" shape="rect"> </a>

      <h2>FILES</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
/etc/resolv.conf          resolver configuration file
/etc/host.conf            resolver configuration file
</pre>
      </div>
    </div>

    <div class="refsect1" title="CONFORMING TO">
      <a id="resolver-3_sect4" name="resolver-3_sect4" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>4.3BSD.</p>
    </div>

    <div class="refsect1" title="SEE ALSO">
      <a id="resolver-3_sect5" name="resolver-3_sect5" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman3/gethostbyname.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">gethostbyname</span>(3)</span></a>, <a class="link" href="../htmlman5/resolv.conf.5.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">resolv.conf</span>(5)</span></a>,
      <span class="citerefentry"><span class="refentrytitle">resolver</span>(5)</span>, <a class="link" href="../htmlman7/hostname.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">hostname</span>(7)</span></a>, <span class="citerefentry"><span class="refentrytitle">named</span>(8)</span></p>
    </div>

    <div class="colophon" title="COLOPHON">
      <a id="resolver-3_sect6" name="resolver-3_sect6" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.25 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, and information about reporting
      bugs, can be found at
      http://www.kernel.org/doc/man-pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright 1993 David Metcalfe (david<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>prism.demon.co.uk)<br />

                  <br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  <br />
                  References consulted:<br />
                      Linux libc source code<br />

                      Lewine's _POSIX Programmer's Guide_ (O'Reilly &amp; Associates, 1991)<br />

                      386BSD man pages<br />

                  Modified 1993-07-25 by Rik Faith (faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu)<br />

                  Modified 2004-10-31 by aeb<br />
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
